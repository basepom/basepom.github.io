<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0-M10 from src/site/markdown/classpath_exceptions.md at 2023-05-28
 | Rendered using Apache Maven Fluido Skin 2.0.0-M6
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0-M10" />
    <title>duplicate-finder-maven-plugin Maven Mojo</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.0.0-M6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.0.0-M6.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <a class="github-fork-ribbon right-top" href="https://github.com/basepom/duplicate-finder-maven-plugin" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2023-05-28<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.0.2-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="plugin-info.html" title="Goals"><span class="none"></span>Goals</a></li>
    <li><a href="simple_options.html" title="Simple configuration"><span class="none"></span>Simple configuration</a></li>
    <li class="active"><a><span class="none"></span>Classpath Exceptions</a></li>
    <li><a href="ignoring_dependencies_and_resources.html" title="Ignoring Dependencies and Resources"><span class="none"></span>Ignoring Dependencies and Resources</a></li>
    <li><a href="result_file_options.html" title="Result File Options"><span class="none"></span>Result File Options</a></li>
    <li><a title="Developer Information"><span class="icon-chevron-down"></span>Developer Information</a>
     <ul class="nav nav-list">
      <li><a href="development_guidelines.html" title="Development Guidelines"><span class="none"></span>Development Guidelines</a></li>
      <li><a href="writing_integration_test.html" title="Writing Integration Tests"><span class="none"></span>Writing Integration Tests</a></li>
      <li><a href="result_file_format.html" title="Result File Format"><span class="none"></span>Result File Format</a></li>
      <li><a href="default_ignored_elements.html" title="Default ignored elements"><span class="none"></span>Default ignored elements</a></li>
     </ul></li>
    <li><a href="https://www.apache.org/licenses/LICENSE-2.0" class="externalLink" title="License"><span class="none"></span>License</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<p>Managing exceptions is an important aspect for the duplicate finder
plugin. Often, third-party dependencies, that can not be changed have
conflicts or include classes and resources that are duplicate with
other classpath elements.</p>
<p>The duplicate finder plugin allows listing and excluding these
conflicts.</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;configuration&gt;
    &lt;exceptions&gt;
        &lt;exception&gt;
            &lt;conflictingDependencies&gt;
                &lt;dependency&gt;
                    &lt;artifactId&gt;...&lt;/artifactId&gt;
                    &lt;groupId&gt;...&lt;/groupId&gt;
                    &lt;version&gt;...&lt;/version&gt;
                    &lt;type&gt;...&lt;/type&gt;
                    &lt;classifier&gt;...&lt;/classifier&gt;
                &lt;/dependency&gt;
                ...
            &lt;/conflictingDependencies&gt;
            &lt;currentProject&gt;false&lt;/currentProject&gt;

            &lt;!-- Version 1.1.1+, removed in 2.0.0 --&gt;
            &lt;bootClasspath&gt;false&lt;/bootClasspath&gt;
            &lt;!-- Version 1.1.1+, removed in 2.0.0 --&gt;

            &lt;resourcePatterns&gt;
                &lt;resourcePattern&gt;...&lt;/resourcePattern&gt;
            &lt;/resourcePatterns&gt;
            &lt;classes&gt;
                &lt;class&gt;...&lt;/class&gt;
            &lt;/classes&gt;
            &lt;packages&gt;
                &lt;package&gt;...&lt;/package&gt;
            &lt;/packages&gt;
            &lt;resources&gt;
                &lt;resource&gt;...&lt;/resource&gt;
            &lt;/resources&gt;
        &lt;/exception&gt;
    &lt;/exceptions&gt;
&lt;/configuration&gt;
</code></pre></div><section><section><section>
<h3>Exception overview</h3>
<p>Within the plugin configuration, one or more exceptions can be listed
in the <code>&lt;exceptions&gt;</code> element. Each exception is applied to all
classpath scopes (compile, runtime and test).</p>
<p>Each exception lists its conflicting dependencies in the <code>conflictingDependencies</code>
element and then optionally the specific conflicting classes and
resources. Any conflict covered by an exception will not be reported
or fail the build.</p>
<p>If an exception only contains a <code>conflictingDependencies</code> element (no
<code>classes</code>, <code>packages</code>, <code>resources</code> or <code>resourcePatterns</code>), <em>any</em>
duplicate between all the listed dependencies is ignored. If any of
these elements is present, <em>only</em> the listed classes or resources will
be ignored.</p>
<p><strong>Warning!</strong> The presence of any of these elements will turn off the
wildcard behavior of an exception. Especially the presence of a
<code>classes</code> or <code>packages</code> element will also turn off the wildcard
behavior for resources and the presence of a <code>resources</code> or
<code>resourcePatterns</code> element will turn off the wildcard behavior for
classes. This was undefined in previous versions of the duplicate
finder plugin.</p><section>
<h4>The <code>conflictingDependencies</code> element</h4>
<p>The <code>conflictingDependencies</code> element lists all artifacts considered
for an exception as <a href="describing_dependencies.html"><code>dependency</code></a> elements. Each
<code>dependency</code> can be fully or partially defined.</p></section><section>
<h4>The <code>currentProject</code> flag</h4>
<p>The <code>currentProject</code> flag signals that the current project should be
added to the exception as a dependency. Any resource or class that is
duplicate between the current project and the listed dependencies will
be ignored.</p>
<p>The option is equivalent to having the current project listed as a
dependency in the <code>conflictingDependencies</code> element.</p>
<p>If the <code>conflictingDependencies</code> element already contains a dependency
for the current project, the flag has no effect.</p>
<p><strong>Warning!</strong> This flag can lead to surprising behavior, especially if
it is used in the root POM of a multi-module build or a parent
pom. The &#x2018;current project&#x2019; is evaluated at runtime and in a
multi-module build it will be applied each time when the plugin is
executed on a sub-project. It is recommended to use this flag
specifically in the project POM where conflicts are expected.</p><section>
<h5>Examples</h5>
<p>In a mult-module build with two sub-projects, sub-project
<code>sub-project-a</code> has a conflict with <code>commons-lang:commons-lang</code> and
<code>sub-project-b</code> has a conflict with
<code>commons-collections:commons-collections</code>. It would be possible to
configure the duplicate finder plugin to ignore these by adding
exceptions to the project root POM:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;project&gt;
  &lt;modules&gt;
    &lt;module&gt;sub-project-a&lt;/module&gt;
    &lt;module&gt;sub-project-b&lt;/module&gt;
  &lt;/modules&gt;

  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.basepom.maven&lt;/groupId&gt;
        &lt;artifactId&gt;duplicate-finder-maven-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;exceptions&gt;
            &lt;exception&gt;
              &lt;currentProject&gt;true&lt;/currentProject&gt;
              &lt;conflictingDependencies&gt;
                &lt;dependency&gt;
                  &lt;groupId&gt;commons-lang&lt;/groupId&gt;
                  &lt;artifactId&gt;commons-lang&lt;/artifactId&gt;
                &lt;/dependency&gt;
              &lt;/conflictingDependencies&gt;
            &lt;/exception&gt;
            &lt;exception&gt;
              &lt;currentProject&gt;true&lt;/currentProject&gt;
              &lt;conflictingDependencies&gt;
                &lt;dependency&gt;
                  &lt;groupId&gt;commons-collections&lt;/groupId&gt;
                  &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
                &lt;/dependency&gt;
              &lt;/conflictingDependencies&gt;
            &lt;/exception&gt;
          &lt;/exceptions&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre></div>
<p>In this case, each of the sub projects (<code>sub-project-a</code> and
<code>sub-project-b</code>) will have any possible conflicts to
<code>commons-lang:commons-lang</code> and
<code>commons-collections:commons-collections</code> excluded. However, this
would also exclude possible conflicts between <code>sub-project-a</code> and
<code>commons-collections:commons-collections</code> or <code>sub-project-b</code> and
<code>commons-lang:commons-lang</code> even though each probably should have been
flagged.</p>
<p>A better way to solve this is moving the exceptions to the actual
sub-project POMs:</p>
<p>Root POM:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;project&gt;
  &lt;modules&gt;
    &lt;module&gt;sub-project-a&lt;/module&gt;
    &lt;module&gt;sub-project-b&lt;/module&gt;
  &lt;/modules&gt;

  &lt;build&gt;
    &lt;pluginManagement&gt;
      &lt;plugins&gt;
        &lt;plugin&gt;
          &lt;groupId&gt;org.basepom.maven&lt;/groupId&gt;
          &lt;artifactId&gt;duplicate-finder-maven-plugin&lt;/artifactId&gt;
        &lt;/plugin&gt;
      &lt;/plugins&gt;
    &lt;/pluginManagement&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre></div>
<p>Sub-project POM <code>sub-project-a</code>:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;project&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.basepom.maven&lt;/groupId&gt;
        &lt;artifactId&gt;duplicate-finder-maven-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;exceptions&gt;
            &lt;exception&gt;
              &lt;currentProject&gt;true&lt;/currentProject&gt;
              &lt;conflictingDependencies&gt;
                &lt;dependency&gt;
                  &lt;groupId&gt;commons-lang&lt;/groupId&gt;
                  &lt;artifactId&gt;commons-lang&lt;/artifactId&gt;
                &lt;/dependency&gt;
              &lt;/conflictingDependencies&gt;
            &lt;/exception&gt;
          &lt;/exceptions&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;
</code></pre></div>
<p>Sub-project POM <code>sub-project-b</code>:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;project&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.basepom.maven&lt;/groupId&gt;
        &lt;artifactId&gt;duplicate-finder-maven-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;exceptions&gt;
            &lt;exception&gt;
              &lt;currentProject&gt;true&lt;/currentProject&gt;
              &lt;conflictingDependencies&gt;
                &lt;dependency&gt;
                  &lt;groupId&gt;commons-collections&lt;/groupId&gt;
                  &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
                &lt;/dependency&gt;
              &lt;/conflictingDependencies&gt;
            &lt;/exception&gt;
          &lt;/exceptions&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre></div>
<p>Now, <code>sub-project-a</code> will have its conflicts with
<code>commons-lang:commons-lang</code> excluded and <code>sub-project-b</code> will have its
conflicts with <code>commons-collections:commons-collections</code> excluded
while any other conflict will still be flagged correctly.</p></section></section><section>
<h4>The <code>bootClasspath</code> flag</h4>
<p>** Available in plugin version 1.1.1, removed in 2.0.0! **</p>
<p><em>This flag only works up to JDK 8! As 2.0.0 no longer supports JDK 8, it was deprecated.</em></p>
<p>The <code>bootClasspath</code> flag signals that an exception to elements on the
boot classpath is defined. Any match between classes or resources in
the listed artifacts and the boot classpath elements is ignored.</p>
<p>This flag can be combined with the <code>currentProject</code> flag.</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;exception&gt;
    &lt;currentProject&gt;false&lt;/currentProject&gt;
    &lt;bootClasspath&gt;false&lt;/bootClasspath&gt;
&lt;/exception&gt;
</code></pre></div>
<p>will ignore any conflict between classes and resources in the current
project and the boot classpath.</p></section><section>
<h4>Managing class exceptions with  <code>classes</code> and <code>packages</code></h4>
<p>The <code>classes</code> and <code>packages</code> elements control which classes are
ignored by the duplicate finder plugin when determining conflicts.</p>
<p>Specific classes are listed as fully-qualified names in the <code>classes</code>
element and full packages are listed in the <code>packages</code> element. Any
package listed will match any class in that package <em>and any
sub-package</em>. This is a very powerful mechanism and it should be used
with care.</p><section>
<h5>Examples</h5>
<p>Exclude a set of classes that are copied around into different jars:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;exception&gt;
  &lt;conflictingDependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;
      &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;
      &lt;artifactId&gt;commons-beanutils-core&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;commons-collections&lt;/groupId&gt;
      &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
    &lt;/dependency&gt;
  &lt;/conflictingDependencies&gt;
    &lt;!-- Well done, Apache! --&gt;
  &lt;classes&gt;
    &lt;class&gt;org.apache.commons.collections.ArrayStack&lt;/class&gt;
    &lt;class&gt;org.apache.commons.collections.Buffer&lt;/class&gt;
    &lt;class&gt;org.apache.commons.collections.BufferUnderflowException&lt;/class&gt;
    &lt;class&gt;org.apache.commons.collections.FastHashMap&lt;/class&gt;
  &lt;/classes&gt;
&lt;/exception&gt;
</code></pre></div>
<p>Exclude a package that was copied into a jar:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;exception&gt;
  &lt;conflictingDependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;(,4.11)&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.hamcrest&lt;/groupId&gt;
      &lt;artifactId&gt;hamcrest-core&lt;/artifactId&gt;
    &lt;/dependency&gt;
  &lt;/conflictingDependencies&gt;
  &lt;packages&gt;
    &lt;package&gt;org.hamcrest&lt;/package&gt;
  &lt;/packages&gt;
&lt;/exception&gt;
</code></pre></div></section></section><section>
<h4>Manging resource exceptions with <code>resources</code> and <code>resourcePatterns</code></h4>
<p>The <code>resources</code> and <code>resourcePatterns</code> elements control which
resources are ignored. Similar to the class elements <code>classes</code> and
<code>packages</code>, <code>resource</code> lists single resource elements and
<code>resourcePatterns</code> can match one or many resources.</p>
<p>A specific resource is listed with its full path in the <code>resources</code>
element. Any resource listed should be fully qualfied and start with a
<code>/</code>. For backwards compatibility, relative resource names (without a
leading <code>/</code>) are accepted but internally treated like absolute
resource names.</p>
<p>The <code>resourcePatterns</code> element accepts any standard Java regular
expression. Resource names are matched against these expressions. If
relative matching is not desired, a pattern must be anchored with
either a a start anchor (<code>^</code>) or an end anchor (<code>$</code>).</p><section>
<h5>Examples</h5>
<p>Exclude a specific resource that is duplicate in the Jersey jars:</p>

<div class="verbatim">
<pre><code class="language-xml">&lt;exception&gt;
  &lt;conflictingDependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.sun.jersey&lt;/groupId&gt;
      &lt;artifactId&gt;jersey-core&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.sun.jersey&lt;/groupId&gt;
      &lt;artifactId&gt;jersey-client&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.sun.jersey&lt;/groupId&gt;
      &lt;artifactId&gt;jersey-server&lt;/artifactId&gt;
    &lt;/dependency&gt;
  &lt;/conflictingDependencies&gt;
  &lt;resources&gt;
    &lt;resource&gt;/META-INF/jersey-module-version&lt;/resource&gt;
  &lt;/resources&gt;
&lt;/exception&gt;
</code></pre></div></section></section></section></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2014–2023
<a href="https://github.com/basepom">The basepom project</a>
</p>
        </div>
      </div>
    </footer>
<script>
  if(anchors) {
    anchors.add();
  }
</script>
  </body>
</html>